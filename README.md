<div align="center">

<img src="https://img.shields.io/badge/-%F0%9F%9B%A1%EF%B8%8F%20NpmProtect%20Intel-ff1a1a?style=for-the-badge" />

<h1>NpmProtect</h1>

<p><strong>We don't like malware. So we fight it â€” automatically.</strong></p>
<p><em>Indie open-source threat intelligence for the npm ecosystem.</em></p>

<br/>

[![Dashboard](https://img.shields.io/badge/ğŸŒ_Dashboard-Live-00ff88?style=for-the-badge&logoColor=black)](https://npmprotect.vercel.app)
[![PyPI](https://img.shields.io/badge/ğŸ_PyPI-npmprotect-3775A9?style=for-the-badge)](https://pypi.org/project/npmprotect)
[![npm](https://img.shields.io/badge/ğŸ“¦_npm-@mozartdev0/npmprotect-cc3534?style=for-the-badge)](https://www.npmjs.com/package/@mozartdev0/npmprotect)
[![GitHub](https://img.shields.io/badge/â­_GitHub-NpmProtect-181717?style=for-the-badge&logo=github)](https://github.com/mozartdev-0/NpmProtect)
[![License](https://img.shields.io/badge/ğŸ“„_License-MIT-red?style=for-the-badge)](LICENSE)

<br/>

```
  â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   
  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘        â–ˆâ–ˆâ•‘   
  â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   
  â•šâ•â•  â•šâ•â•â•â•â•šâ•â•     â•šâ•â•     â•šâ•â•â•šâ•â•     â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•    â•šâ•â•   â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•   â•šâ•â•   
```

</div>

---

## ğŸ” O que Ã©?

NpmProtect Ã© um sistema **automatizado de inteligÃªncia contra malware** no ecossistema npm. O pipeline coleta hashes de amostras ativas, cruza com mÃºltiplas fontes de threat intel, gera relatÃ³rios tÃ©cnicos com IA e publica tudo em tempo real â€” **de graÃ§a, sem conta, sem paywall.**

> Feito por um dev de 10 anos. SÃ©rio. ğŸ”¥

---

## âš™ï¸ Stack

<div align="center">

| Camada | Tecnologia |
|--------|-----------|
| ğŸ§  **IA / RelatÃ³rios** | ![OpenRouter](https://img.shields.io/badge/OpenRouter-Llama_3_70B-7c3aed?style=flat-square) |
| ğŸ¦  **Feed de Malwares** | ![MalwareBazaar](https://img.shields.io/badge/MalwareBazaar-abuse.ch-ea580c?style=flat-square) |
| ğŸ”¬ **AnÃ¡lise Multi-engine** | ![VirusTotal](https://img.shields.io/badge/VirusTotal-Dual_Key-4285F4?style=flat-square&logo=virustotal&logoColor=white) |
| â˜ï¸ **Banco de Dados** | ![Supabase](https://img.shields.io/badge/Supabase-Realtime-3ECF8E?style=flat-square&logo=supabase&logoColor=white) |
| ğŸŒ **Dashboard** | ![Vercel](https://img.shields.io/badge/Vercel-Deployed-000000?style=flat-square&logo=vercel&logoColor=white) |
| ğŸ **Backend / Hunter** | ![Python](https://img.shields.io/badge/Python-asyncio-3776AB?style=flat-square&logo=python&logoColor=white) |
| ğŸ“¦ **CLI Python** | ![PyPI](https://img.shields.io/badge/PyPI-npmprotect-3775A9?style=flat-square&logo=pypi&logoColor=white) |
| ğŸŸ¨ **SDK JavaScript** | ![npm](https://img.shields.io/badge/npm-@mozartdev0/npmprotect-cc3534?style=flat-square&logo=npm&logoColor=white) |

</div>

---

## ğŸ”„ Pipeline de AnÃ¡lise

```
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  MalwareBazaar  â”‚  â† Feed de hashes SHA-256 ativos
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   VirusTotal    â”‚  â† Confirma existÃªncia (dual-key engine)
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  Llama 3 70B via OpenRouter     â”‚  â† Gera relatÃ³rio tÃ©cnico
  â”‚  MITRE ATT&CK Â· IOCs Â· Static  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   VirusTotal    â”‚  â† Publica relatÃ³rio como comentÃ¡rio pÃºblico
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚    Supabase     â”‚  â† Sincroniza em tempo real
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚  npmprotect.vercel.app   â”‚  â† Dashboard pÃºblico, sem login
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ CLI Python

```bash
pip install npmprotect
```

### Comandos

```bash
npmprotect check <pacote>          # ğŸ” Verifica se um pacote npm Ã© seguro
npmprotect check <pacote> --vt     # ğŸ”¬ Verifica + anÃ¡lise VirusTotal
npmprotect latest --limit 10       # ğŸ¦  Ãšltimos malwares detectados
npmprotect report <hash>           # ğŸ“„ RelatÃ³rio completo por SHA-256
npmprotect stats                   # ğŸ“Š EstatÃ­sticas da base
```

### Exemplos reais

```bash
$ npmprotect check lodahs
  âš ï¸  Nome similar a pacotes populares: lodash
  âš ï¸  28 downloads/semana â€” pacote pouco conhecido!

$ npmprotect check expresss --vt
  âš ï¸  Typosquat de: express
  âš ï¸  DescriÃ§Ã£o: "temp test" â€” suspeito!

$ npmprotect check express --vt
  âœ… express â€” 69,722,421 downloads/semana
  âœ… VirusTotal: 0/97 engines â€” limpo.
```

---

## ğŸŸ¨ SDK JavaScript

```bash
npm install @mozartdev0/npmprotect
```

Integre threat intelligence do NpmProtect no seu site ou app â€” **sem config, sem API key, zero dependÃªncias.**

```javascript
const { NpmProtect } = require('@mozartdev0/npmprotect')

const np = new NpmProtect()

// Ãšltimos malwares detectados
const latest = await np.latest(10)

// Verificar pacote
const results = await np.check('lodash')

// RelatÃ³rio completo
const report = await np.report('abc123...')

// EstatÃ­sticas
const stats = await np.stats()
// { total: 42, lastDetection: '2026-02-14T...', dashboard: 'https://npmprotect.vercel.app' }

// Info do pacote no npm
const info = await np.npmInfo('express')
// { exists: true, version: '5.2.1', downloads: 69722421, ... }
```

---

## ğŸš€ Rodando o Hunter localmente

### 1. Clone

```bash
git clone https://github.com/mozartdev-0/NpmProtect
cd NpmProtect
pip install -r requirements.txt
```

### 2. Configure o `.env`

```env
SUPABASE_URL=https://xxxx.supabase.co
SUPABASE_SERVICE_ROLE=eyJ...
DISCORD_WEBHOOK=https://discord.com/api/webhooks/...
OPENROUTER_API_KEY=sk-or-...
VT_API_KEY1=sua_chave_vt_1

VT_API_KEY2=sua_chave_vt_2        # opcional â€” dobra o rate limit
MALWARE_BAZAAR_KEY=sua_chave
BATCH_SIZE=5                      # malwares por sessÃ£o (padrÃ£o: 5)
COOLDOWN_SECONDS=45               # espera entre anÃ¡lises (padrÃ£o: 45)
```

### 3. Rode

```bash
python servidor/hunter.py
```

---

## ğŸ”‘ Como obter as chaves de API

<details>
<summary><b>ğŸŸ¢ Supabase â€” SUPABASE_URL e SUPABASE_SERVICE_ROLE</b></summary>

1. Acesse [supabase.com](https://supabase.com) e crie uma conta gratuita
2. Crie um novo projeto
3. VÃ¡ em **Project Settings â†’ API**
4. Copie:
   - **Project URL** â†’ `SUPABASE_URL`
   - **service_role (secret)** â†’ `SUPABASE_SERVICE_ROLE` âš ï¸ *nunca exponha publicamente*
   - **anon public** â†’ use no CLI como `SUPABASE_KEY` â€” segura pra expor

> A tabela `reports` precisa existir com as colunas: `hash`, `report_id`, `content`, `analyst`, `created_at`

</details>

<details>
<summary><b>ğŸ”µ VirusTotal â€” VT_API_KEY1 / VT_API_KEY2</b></summary>

1. Acesse [virustotal.com](https://www.virustotal.com) e crie uma conta gratuita
2. Clique no seu avatar â†’ **API Key**
3. Cole como `VT_API_KEY1`
4. Crie uma segunda conta para `VT_API_KEY2` e dobrar o rate limit

> Plano gratuito: **4 requests/minuto**. Com 2 chaves o hunter alterna automaticamente.

</details>

<details>
<summary><b>ğŸŸ£ OpenRouter â€” OPENROUTER_API_KEY</b></summary>

1. Acesse [openrouter.ai](https://openrouter.ai) e crie uma conta
2. VÃ¡ em **Keys â†’ Create Key**
3. Cole como `OPENROUTER_API_KEY` (`sk-or-...`)

> Modelo usado: `google/gemini-2.0-flash-lite-001`. Tem crÃ©ditos gratuitos ao criar conta.

</details>

<details>
<summary><b>ğŸŸ  MalwareBazaar â€” MALWARE_BAZAAR_KEY</b></summary>

1. Acesse [bazaar.abuse.ch](https://bazaar.abuse.ch) e crie uma conta
2. VÃ¡ em **Account â†’ API Key**
3. Cole como `MALWARE_BAZAAR_KEY`

> Totalmente gratuito. Sem limites agressivos.

</details>

---

## ğŸ“Š Dashboard ao vivo

**[npmprotect.vercel.app](https://npmprotect.vercel.app)**

- ğŸ”´ Hashes SHA-256 detectados em tempo real
- ğŸ“„ RelatÃ³rios com MITRE ATT&CK, anÃ¡lise estÃ¡tica e dinÃ¢mica
- ğŸ” Busca por hash ou conteÃºdo
- âš¡ Feed ao vivo via Supabase Realtime
- ğŸŒ PÃºblico â€” sem login, sem conta

---

## ğŸ—ºï¸ Roadmap

- [x] ğŸ”„ Pipeline de anÃ¡lise automatizado
- [x] ğŸŒ Dashboard pÃºblico em tempo real
- [x] ğŸ“ PublicaÃ§Ã£o de relatÃ³rios no VirusTotal
- [x] ğŸ CLI Python global (`pip install npmprotect`)
- [x] ğŸŸ¨ SDK JavaScript (`npm install @mozartdev0/npmprotect`)
- [x] ğŸ” VerificaÃ§Ã£o real de pacotes + typosquatting detection
- [ ] ğŸ›¡ï¸ ProteÃ§Ã£o ativa no `npm install`
- [ ] ğŸ“ˆ Scoring de severidade por hash
- [ ] ğŸ”Œ API pÃºblica REST
- [ ] ğŸ“¤ Upload de arquivos para anÃ¡lise manual

---

## ğŸ“„ LicenÃ§a

MIT â€” use, modifique, contribua.

---

<div align="center">

**Feito por [Mozart_Dev](https://github.com/mozartdev-0) Â· Vynex Labs**

*Fighting malware, one hash at a time.* ğŸ›¡ï¸

<br/>

[![Dashboard](https://img.shields.io/badge/ğŸŒ-npmprotect.vercel.app-ff1a1a?style=for-the-badge)](https://npmprotect.vercel.app)

</div>
